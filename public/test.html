<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Orbitmate API test</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="session-controls.css">
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <div class="header">
        <img src="assets/Orbitmate.png" alt="Orbitmate Logo" class="logo" width="100" height="100">
        <div>
            <h1>Orbitmate API 테스트 페이지</h1>
            <p>백엔드 API 테스트 및 디버깅을 위한 페이지입니다</p>
        </div>
        <a href="/" class="test-button" style="background-color: #007bff;">메인 채팅 페이지로</a>
    </div>

    <!-- 간단한 테스트 채팅 UI -->
    <div id="test-chat-container">
        <h3>테스트 채팅 (메시지 ID 표시)</h3>
        <div id="chat-box"></div>
        <div id="input-area">
            <input type="text" id="message-input" placeholder="메시지를 입력하세요...">
            <button id="send-button">전송</button>
        </div>        <div id="ai-selector" style="margin-top: 10px; text-align: center;">
            <span>AI Provider:</span>
            <label><input type="radio" name="aiProvider" value="ollama"> Ollama</label>
            <label><input type="radio" name="aiProvider" value="gemini" checked> Gemini</label>
            <span style="margin-left: 15px;">Ollama Model:</span>
            <label><input type="radio" name="ollamaModel" value="gemma3:1b"> Gemma3:1b</label>
            <label><input type="radio" name="ollamaModel" value="gemma3:4b" checked> Gemma3:4b</label>
            <label><input type="radio" name="ollamaModel" value="gemma3:12b"> Gemma3:12b</label>
            <label><input type="checkbox" id="it-qat"> 양자화</label>
            <!-- 양자화의 경우 모델명 뒤에 -it-qat가 붙는다 ex: gemma3:4b-it-qat-->
            <br> 
            <label for="system-prompt-input" style="margin-left: 15px;">System Prompt:</label>
            <input type="text" id="system-prompt-input" placeholder="Optional system prompt..." style="width: 200px; margin-left: 5px;">
            <label style="margin-left: 15px;"><input type="checkbox" id="stream-mode-checkbox"> Stream Mode</label>
        </div>
        <div class="session-controls" style="margin-top: 10px; text-align: center;">
            <button id="reset-session-button" style="background-color: #dc3545;">새 세션 시작</button>
            <button id="refresh-messages-button" style="background-color: #17a2b8;">메시지 새로고침</button>
        </div>
    </div>

    <div id="api-test-container">
        <!-- 사용자 관리 -->
        <div class="api-section">
            <h3>사용자 관리</h3>
            <div>
                <input type="text" id="register-username" placeholder="사용자명">
                <input type="email" id="register-email" placeholder="이메일">
                <input type="password" id="register-password" placeholder="비밀번호">
                <button id="register-button">회원가입</button>
            </div>
            <div>
                <input type="email" id="login-email" placeholder="이메일">
                <input type="password" id="login-password" placeholder="비밀번호">
                <button id="login-button">로그인</button>
            </div>
            <div>
                <input type="text" id="user-id-input" placeholder="사용자 ID (로그인 후 자동 입력)">
                <button id="get-user-profile-button">프로필 조회</button>
                <button id="delete-user-button">회원 탈퇴</button>
            </div>
             <div>
                <input type="text" id="user-settings-user-id" placeholder="사용자 ID">
                <textarea id="user-settings-payload" placeholder='{\"theme\": \"dark\"}'></textarea>
                <button id="get-user-settings-button">설정 조회</button>
                <button id="update-user-settings-button">설정 수정</button>
            </div>
            <div>
                <input type="text" id="profile-image-user-id" placeholder="사용자 ID">
                <input type="file" id="profile-image-file">
                <button id="upload-profile-image-button">프로필 이미지 업로드</button>
            </div>
        </div>

        <!-- 채팅 세션 관리 -->
        <div class="api-section">
            <h3>채팅 세션 관리</h3>
            <div>
                <input type="text" id="create-session-user-id" placeholder="사용자 ID">
                <input type="text" id="create-session-title" placeholder="세션 제목">
                <input type="text" id="create-session-category" placeholder="카테고리 (선택)">
                <button id="create-session-button">세션 생성</button>
            </div>
            <div>
                <input type="text" id="get-sessions-user-id" placeholder="사용자 ID">
                <button id="get-user-sessions-button">사용자 세션 목록 조회</button>
            </div>
            <div>
                <input type="text" id="session-id-input" placeholder="세션 ID (생성/조회 후 자동 입력)">
                <textarea id="update-session-payload" placeholder='{\"title\": \"수정된 제목\"}'></textarea>
                <button id="update-session-button">세션 정보 수정</button>
                <button id="delete-session-button">세션 삭제</button>
                <button id="get-session-messages-button">세션 메시지 조회</button>
            </div>
        </div>

        <!-- 채팅 메시지 관리 -->
        <div class="api-section">
            <h3>채팅 메시지 관리</h3>
            <div>
                <input type="text" id="message-id-input" placeholder="메시지 ID">
                <input type="text" id="edit-message-content" placeholder="수정할 메시지 내용">
                <button id="edit-message-button">메시지 수정</button>
            </div>
            <div>
                <input type="text" id="reaction-message-id" placeholder="메시지 ID">
                <input type="text" id="reaction-content" placeholder="리액션 (예: 👍)">
                <button id="add-reaction-button">리액션 추가</button>
                <button id="remove-reaction-button">리액션 제거</button>
            </div>
            <div>
                <input type="text" id="delete-message-id" placeholder="메시지 ID">
                <button id="delete-message-button">메시지 삭제</button>
            </div>
            <div>
                <input type="text" id="upload-file-session-id" placeholder="세션 ID">
                <input type="file" id="chat-file-input">
                <button id="upload-file-button">파일 업로드 (채팅)</button>
            </div>
        </div>        <!-- 검색 기능 -->
        <div class="api-section">
            <h3>검색 기능</h3>
            
            <!-- 위키피디아 검색 -->
            <h4>📚 위키피디아 검색</h4>
            <div>
                <input type="text" id="wikipedia-search-query" placeholder="위키피디아 검색어" value="대한민국">
                <input type="number" id="wikipedia-search-limit" placeholder="결과 개수" value="5" min="1" max="50">
                <select id="wikipedia-search-language">
                    <option value="ko">한국어 (ko)</option>
                    <option value="en">영어 (en)</option>
                    <option value="ja">일본어 (ja)</option>
                    <option value="zh">중국어 (zh)</option>
                </select>
                <button id="wikipedia-search-button">위키피디아 검색</button>
            </div>
            
            <!-- 위키피디아 검색 결과 표시 영역 -->
            <div id="wikipedia-results-display" class="search-results-container"></div>
            
            <!-- 날씨 검색 -->
            <h4>🌤️ 날씨 검색 (IP 기반 자동 위치 감지)</h4>
            <div>
                <select id="weather-units">
                    <option value="metric">섭씨 (°C)</option>
                    <option value="imperial">화씨 (°F)</option>
                    <option value="kelvin">켈빈 (K)</option>
                </select>
                <select id="weather-lang">
                    <option value="ko">한국어</option>
                    <option value="en">영어</option>
                    <option value="ja">일본어</option>
                </select>
                <input type="text" id="weather-city" placeholder="도시명 (선택사항 - 비워두면 IP 기반 자동감지)">
                <button id="weather-search-button">날씨 검색</button>
            </div>
            
            <!-- 좌표 직접 입력 (고급 옵션) -->
            <div style="margin-top: 10px;">
                <input type="number" id="weather-lat" placeholder="위도 (선택사항)" step="any" min="-90" max="90">
                <input type="number" id="weather-lon" placeholder="경도 (선택사항)" step="any" min="-180" max="180">
                <span style="font-size: 0.9em; color: #666;">※ 위도/경도 직접 입력 시 IP 감지 무시</span>
            </div>
            
            <!-- 날씨 검색 결과 표시 영역 -->
            <div id="weather-results-display" class="search-results-container"></div>
        </div>

        <div class="api-section">
            <h3>API 응답</h3>
            <pre id="api-response"></pre>
        </div>
    </div>    <div class="footer">
        <p>© 2025 Orbitmate - API 테스트 도구 (HTTP SSE 스트리밍)</p>
    </div>

    <!-- 메인 테스트 스크립트 -->
    <script type="module" src="testScript.js"></script>
</body>
</html>
